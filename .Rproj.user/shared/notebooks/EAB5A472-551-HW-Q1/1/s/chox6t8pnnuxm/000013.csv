"0",""
"0","# Data"
"0","y <- c(16/74, 9/99, 10/58, 13/70, 19/121, 20/77, 18/104, 17/129, 35/308, 55/119)"
"0","z <- c(12/25, 1/19, 2/16, 4/48, 9/217, 7/74, 9/38, 8/162)"
"0",""
"0","# Total counts"
"0","n_y <- c(74, 99, 58, 70, 121, 77, 104, 129, 308, 119)"
"0","n_z <- c(25, 19, 16, 48, 217, 74, 38, 162)"
"0",""
"0","# Prior parameters"
"0","alpha_y <- 1; beta_y <- 1"
"0","alpha_z <- 1; beta_z <- 1"
"0",""
"0","# Posterior parameters"
"0","alpha_y_post <- alpha_y + sum(y * n_y)"
"0","beta_y_post <- beta_y + sum((1 - y) * n_y)"
"0","alpha_z_post <- alpha_z + sum(z * n_z)"
"0","beta_z_post <- beta_z + sum((1 - z) * n_z)"
"0",""
"0","# Simulate from the posterior"
"0","set.seed(123)"
"0","theta_y_samples <- rbeta(1000, alpha_y_post, beta_y_post)"
"0","theta_z_samples <- rbeta(1000, alpha_z_post, beta_z_post)"
"0",""
"0","# Compute the difference"
"0","diff_samples <- theta_y_samples - theta_z_samples"
"0",""
"0","# Plot"
"0","hist(diff_samples, main = ""Posterior Distribution of Difference"","
"0","     xlab = expression(theta[y] - theta[z]), breaks = 40, col = ""skyblue"")"
